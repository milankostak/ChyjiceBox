var ChyjiceBox={};
$(document).ready(function(){function na(a,b,d,c,e,f){this.href=a;this.title=b;this.type=d;this.loaded=!1;this.date=c;this.lat=e;this.longt=f}function oa(){$("[data-chyjicebox]").each(function(){var a=$(this),b=a.attr("href"),d=b.toLowerCase().split(".")[b.toLowerCase().split(".").length-1];if(-1!==$.inArray(d,pa)){var G=a.attr("data-chyjicebox"),e=a.children().attr("alt"),k=a.attr("data-date"),l=a.attr("data-lat"),p=a.attr("data-long"),g=0;""!==G&&(g=f++);var m=new na(b,e,"webm"===d||"mp4"===d?n.VIDEO:
n.IMAGE,k,l,p);""!==G&&"pdf"!==d&&h.push(m);a.click(function(e){if(1===e.button)return!0;""===G&&(t=void 0!==a.attr("data-fittoscreen"));(H="pdf"===d)?(y.attr("src",b),aa()):((q=""!==G)?r.addClass("cursorpointer"):r.removeClass("cursorpointer"),v=!0,w=!1,c=m,f=g,qa(),U());return!1})}})}function U(){c.loaded||z.show();var a=function(){c.loaded=!0;if(!w){ba(this);for(var a=1;q&&2>=a;a++)ra(a)}};if(c.type===n.IMAGE){var b=new Image;b.onload=a;b.onerror=function(){c.loaded=!0;w||ba(!1)}}else b=document.createElement("video"),
b.oncanplay=a;I=!0;b.src=c.href}function ba(a){z.hide();if(c.type===n.IMAGE){k.removeClass("top");var b=A=(p="object"===typeof a)?a.width:200;a=B=p?a.height:50}else k.addClass("top"),p=!0,b=A=a.videoWidth,a=B=a.videoHeight;v&&aa();p?(b=ca(),da(b[0],b[1],g.scrollTop()+b[2])):(k.css("display","none"),da(b,a,ea()));C||(D.css("display",0<f&&q?"block":"none"),E.css("display",f<h.length-1&&q?"block":"none"));x.css("height",g.height())}function aa(){V();e.show();if(t||H){var a=J.innerWidth();J.css("overflow",
"hidden");a=J.innerWidth()-a;K.css("padding-right",a+"px")}x.fadeIn(200,function(){(H?y:l).fadeIn(100,function(){x.css("height",g.height())})})}function L(){if(document.fullscreenElement===m||document.webkitFullscreenElement===m)document.exitFullscreen(),u.removeClass("shrink");g.unbind("keydown.chyjicebox-keypress");z.hide();y.hide();l.fadeOut(70);e.fadeOut(250,function(){w=!0;if(t||H)J.css("overflow","auto"),K.css("padding-right","0");x.hide();r.html("");k.html("");""!==y.attr("src")&&y.attr("src",
"");V()})}function ca(){var a=$(window).width(),b=$(window).height(),d=A,c=B,e=!1,f=!1;t&&c>b&&(c=b,d=A*c/B,e=!0);t&&d>a&&(d=a,c=B*d/A,f=!0);a=0;t&&(f||!f&&!e)&&(a=(b-c)/2);return[d,c,a]}function da(a,b,d){var e=$(window).width(),f=v?1:300,h=v?1:180;a=Math.round(a);b=Math.round(b);d=Math.round(d);var g=Math.round((e-a)/2);0>g&&(g=0);var m=a-20;l.css("width")===a+"px"&&l.css("height")===b+"px"&&l.css("top")===d+"px"&&l.css("left")===g+"px"&&(h=f=0);r.fadeOut(h,function(){void 0!==c.title?(k.html(sa()),
k.animate({width:m},f),"none"===k.css("display")&&p&&k.fadeIn(f)):(k.html(""),k.css("display","none"));l.animate({width:a,height:b,top:d,left:g},f,function(){r.html(c.type===n.IMAGE?p?'<img src="'+c.href+'" width="'+a+'px" height="'+b+'px">':'<div class="chyjicebox-notfound">Obr\u00e1zek nebyl nalezen.</strong></div>':'<video width="'+a+'px" src="'+c.href+'" controls></video>');I=!1;r.fadeIn(h);M.attr("href",c.href);if(c.type===n.VIDEO)$("#chyjicebox > #imgbox video").on("play",fa)})})}function sa(){var a=
q?f+1+"/"+h.length:"";void 0!==c.date&&(a+="&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;"+c.date);if(""!==c.lat&&void 0!==c.lat){var b=c.longt.substring(0,c.longt.length-1);var d=c.lat.substring(0,c.lat.length-1);c.longt.toUpperCase().endsWith("W")&&(b="-"+b);c.lat.toUpperCase().endsWith("S")&&(d="-"+d);b=ha()?"https://mapy.cz/zakladni?x="+b+"&y="+d+"&z=17&source=coor&id="+b+"%2C"+d:"https://www.google.com/maps?q=loc:"+d+","+b;a+='&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<a href="'+(b+'">Mapa</a>')}return a+=
"&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;"+c.title}function ra(a){a=W?a:-a;var b=f+a;0>f+a?b=0:f+a>h.length-1&&(b=h.length-1);var d=h[b];d.loaded||d.type===n.VIDEO||(a=new Image,a.onload=function(){d.loaded=!0},a.src=d.href)}function N(){!I&&0<f&&q&&(c=h[--f],W=v=!1,U())}function F(){!I&&f<h.length-1&&q&&(c=h[++f],W=!0,v=!1,U())}function ea(){var a=2*$(window).height()/5;return g.scrollTop()+a}function ta(){X=!0;var a=$(window).width(),b=ca(),d=b[0],c=b[1];b=b[2];l.animate({width:p?d:200,height:p?c:
50,top:p?g.scrollTop()+b:ea(),left:(a-d)/2},200);k.animate({width:d-20},200);r.children().animate({width:d,height:c},200);x.css("height",g.height())}function qa(){g.bind("keydown.chyjicebox-keypress",function(a){var b=a.ctrlKey||a.shiftKey||a.altKey;switch(a.which){case 32:return c.type===n.VIDEO&&(b=O(),b.paused?b.play():b.pause(),a.preventDefault()),!1;case 27:L();a.preventDefault();break;case 87:case 65:case 33:case 38:case 37:if(!b)return N(),a.preventDefault(),P(),!1;a.shiftKey^a.ctrlKey&&37===
a.which&&c.type===n.VIDEO&&(ia(a.shiftKey?-3:-30),a.preventDefault());break;case 83:case 68:case 34:case 40:case 39:if(!b)return F(),a.preventDefault(),P(),!1;a.shiftKey^a.ctrlKey&&39===a.which&&c.type===n.VIDEO&&(ia(a.shiftKey?3:30),a.preventDefault());break;case 70:ja();break;case 8:case 13:a.preventDefault()}})}function P(){C||(C=!0,ua(),D.animate({left:"-150"},350,function(){D.hide().css("left",0)}),E.animate({right:"-150"},350,function(){E.hide().css("right",0)}),Q.animate({top:"-50"},350,function(){Q.hide().css("top",
0)}),u.animate({top:"-50"},350,function(){u.hide().css("top",0)}),R.animate({top:"-50"},350,function(){R.hide().css("top",0)}),M.animate({top:"-50"},350,function(){M.hide().css("top",0)}))}function V(){C&&(C=!1,0<f&&q&&D.css("left",-150).show().animate({left:"0"},350),f<h.length-1&&q&&E.css("right",-150).show().animate({right:"0"},350),Q.css("top",-50).show().animate({top:"0"},350),u.css("top",-50).show().animate({top:"0"},350),R.css("top",-50).show().animate({top:"0"},350),M.css("top",-50).show().animate({top:"0"},
350),k.show())}function ua(){e.bind("mousemove.chyjicebox-mousemove",function(a){V();e.unbind("mousemove.chyjicebox-mousemove");c.type==n.VIDEO&&(clearTimeout(Y),O().paused||fa())})}function fa(){clearTimeout(Y);Y=setTimeout(function(){P();k.hide()},2E3)}function ia(a){var b=O();a=b.currentTime+a;b.currentTime=0>a?0:a>b.duration?b.duration:a}function O(){return $("#chyjicebox > #imgbox video")[0]}function ja(){document.fullscreenElement===m||document.webkitFullscreenElement===m?(document.exitFullscreen(),
u.removeClass("shrink")):(m.requestFullscreen(),u.addClass("shrink"))}function ha(){var a=Z.get("chyjicebox-maps");return""===a||"mapycz"===a}var g=$(document),K=$("body"),J=$("html"),pa="gif jpg jpeg png pdf webm mp4".split(" "),A=0,B=0,f=0,q=!1,v=!0,I=!1,p=!0,w=!0,W=!0,H=!1,t=!0,C=!1,c=null,h=[],X=!0,ka=null,S=null,T=null,n={IMAGE:1,VIDEO:2};K.append('<div id="chyjicebox-wrapper"></div>');var e=$("#chyjicebox-wrapper");e.append('<div id="chyjicebox"></div>');var l=$("#chyjicebox");e.append('<div id="chyjicebox-overlay"></div>');
var x=$("#chyjicebox-overlay");K.append('<div id="chyjicebox-loading"></div>');var z=$("#chyjicebox-loading");l.append('<div id="imgbox"></div>');var r=$("#chyjicebox #imgbox");l.append('<div id="title"></div>');var k=$("#chyjicebox #title");e.append('<button id="chyjicebox-prev" type="button" title="P\u0159edchoz\u00ed">\u25c1</button>');var D=$("#chyjicebox-prev");e.append('<button id="chyjicebox-next" type="button" title="Dal\u0161\u00ed">\u25b7</button>');var E=$("#chyjicebox-next");e.append('<button id="chyjicebox-close" title="Zav\u0159\u00edt">\u2715</button>');
var Q=$("#chyjicebox-close");e.append('<button id="chyjicebox-full" title="Cel\u00e1 obrazovka"></button>');var u=$("#chyjicebox-full");e.append('<button id="chyjicebox-settings" title="Nastaven\u00ed"></button>');var R=$("#chyjicebox-settings");e.append('<div id="chyjicebox-settings-block">\n\t\t<input type="radio" name="maps" id="mapycz" value="mapycz"><label for="mapycz">Mapy.cz</label>\n\t\t<input type="radio" name="maps" id="google" value="google"><label for="google">Google maps</label>\n\t</div>');
var va=$("#chyjicebox-settings-block"),la=$("#chyjicebox-settings-block #mapycz"),ma=$("#chyjicebox-settings-block #google");e.append('<a id="chyjicebox-newtab" href="" onclick="window.open(this.href); return false;" title="Otev\u0159\u00edt ve vlastn\u00edm okn\u011b"></a>');var M=$("#chyjicebox-newtab");e.append('<iframe id="chyjicebox-iframe" src=""></iframe>');var y=$("#chyjicebox-iframe");z.click(L);Q.click(L);x.click(L);D.click(N);E.click(F);r.click(function(){var a=O();(c.type!==n.VIDEO||0===
a.currentTime||a.paused)&&F()});e.on("touchstart",function(a){S=a.touches[0].clientX;T=a.touches[0].clientY});e.on("touchmove",function(a){if(S&&T){var b=S-a.touches[0].clientX;Math.abs(b)>Math.abs(T-a.touches[0].clientY)&&(0<b?F():N(),P());T=S=null}});$(window).resize(function(){X&&(X=!1,clearTimeout(ka),ka=setTimeout(ta,500))});l.bind("mousewheel DOMMouseScroll",function(a){if(q){var b=a.originalEvent.wheelDelta||-a.detail;0>(0<b?1:0>b?-1:0)?F():N();a.preventDefault()}});var Y=null,m=document.body;
m.requestFullscreen=m.requestFullscreen||m.webkitRequestFullscreen;document.exitFullscreen=document.exitFullscreen||document.webkitExitFullscreen;u.click(ja);R.click(function(){ha()?la.prop("checked",!0):ma.prop("checked",!0);va.fadeToggle(120)});la.click(function(){return Z.set("chyjicebox-maps","mapycz")});ma.click(function(){return Z.set("chyjicebox-maps","google")});var Z={set:function(a,b,c,e){c=void 0===c?7:c;e=void 0===e?"/":e;c=(new Date(Date.now()+864E5*c)).toUTCString();document.cookie=
a+"="+encodeURIComponent(b)+"; expires="+c+"; path="+e},get:function(a){return document.cookie.split("; ").reduce(function(b,c){var d=c.split("=");return d[0]===a?decodeURIComponent(d[1]):b},"")},"delete":function(a,b){set(a,"",-1,void 0===b?"/":b)}};(new Image).src="/img/chyjicebox/loading.gif";(new Image).src="/img/chyjicebox/full.png";(new Image).src="/img/chyjicebox/shrink.png";(new Image).src="/img/chyjicebox/settings.png";(new Image).src="/img/chyjicebox/newtab.png";ChyjiceBox.init=function(a){a&&
(t=!1);oa()};ChyjiceBox.clean=function(){f=h.length=0;w=!0;z.hide()};ChyjiceBox.isClosed=function(){return w}});